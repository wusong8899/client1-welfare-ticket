(()=>{var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t);const r=flarum.core.compat["forum/app"];var a=e.n(r);const n=flarum.core.compat.extend,i=flarum.core.compat["components/IndexPage"];var o=e.n(i);const l=flarum.core.compat["components/LinkButton"];var s=e.n(l);const c=flarum.core.compat["components/UserPage"];var u=e.n(c);function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function f(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,p(e,t)}const d=flarum.core.compat.Component;var h=e.n(d);const w=flarum.core.compat.app;var y=e.n(w);const v=flarum.core.compat["components/LoadingIndicator"];var k=e.n(v);const g=flarum.core.compat["components/Button"];var b=e.n(g);flarum.core.compat["components/Link"];var T=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.view=function(){var e=this.attrs.welfareTicketHistory,t=e.welfare_id().toString().substring(1),r=app.forum.attribute("antoinefr-money.moneyname")||"[money]",a=e.welfareData(),n=a.result(),i=null===n?[]:JSON.parse(n),o=JSON.parse(a.settings()),l={1:app.translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-count",{count:1,multiplier:o.win1Multiplier}),2:app.translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-count",{count:2,multiplier:o.win2Multiplier}),3:app.translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-count",{count:3,multiplier:o.win3Multiplier})},s=e.id(),c=e.bet(),u=e.win_total(),p=r.replace("[money]",u),f=r.replace("[money]",c),d=parseInt(e.opened()),h="",w="";if(!1==("dealer"===e.numbers())){var y=JSON.parse(e.numbers()),v=y.length,k=0;return 0===d?(h=app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-not-ready"),w="color:gray"):0===u?(h=app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-not-hit"),w="color:red"):(h=app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-win-price",{hitCount:v,money:p}),w="color:green"),m("div",{className:"welfareTicketHistoryContainer"},m("div",{style:"padding-top: 5px;font-size: 16px;color: lightgoldenrodyellow;"},m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-season-3D",{id:t}))),m("div",null,m("div",{style:"float: right;margin-top:-25px;"},null!==n&&i.map((function(e){var t=y.indexOf(parseInt(e)),r="display:inline-block;margin-left: 2px;padding:4px;";return u>0&&-1!==t&&k<v&&(r+="border: 1px solid lightgoldenrodyellow;border-radius: 4px;",k++),m("div",{style:r},m("div",{class:"WelfareTicketBallBlue",style:"opacity: 0.9;width: 24px;height: 27px;line-height: 27px;"},e))})))),m("div",{style:"padding-top: 5px;"},m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-id"),": "),s," | ",m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-bet"),": "),f," | ",m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-numbers"),": "),m("div",{style:"display:inline-block;border:1px solid var(--text-color);padding: 0px 4px;margin-left: 4px;"},y.join(","))),m("div",{style:"padding-top: 5px;"},m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-type"),": "),l[v]," | ",m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result"),": "),m("span",{style:w},h)))}if(0===d)h=app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-not-ready"),w="color:gray";else{var g=u-c,b=r.replace("[money]",Math.abs(g));g<=0?(w="color:red",h=app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-dealer-negative-profit",{money:b})):(w="color:green",h=app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-dealer-positive-profit",{money:b}))}return m("div",{className:"welfareTicketHistoryContainer"},m("div",{style:"padding-top: 5px;font-size: 16px;color: lightgoldenrodyellow;"},m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-season-3D",{id:t}))),m("div",null,m("div",{class:"WelfareRainbowTextAnimated",style:"float: right;margin-top:-25px;font-size: 24px;"},m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-is-dealer")))),m("div",{style:"padding-top: 5px;"},m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-dealer-bet"),": "),f),m("div",{style:"padding-top: 5px;"},m("b",null,app.translator.trans("wusong8899-welfare-ticket.forum.welfare-result-dealer-profit"),": "),m("span",{style:w},h)))},r.precisionRound=function(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r},t}(h()),x=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.loading=!0,this.moreResults=!1,this.welfareTicketHistory=[],this.welfareTicketHistorySummary=null,this.user=this.attrs.params.user,this.loadResults()},r.view=function(){var e,t,r,a=this,n=y().forum.attribute("antoinefr-money.moneyname")||"[money]";return this.loading?(e=k().component({size:"large"}),t=n.replace("[money]","-"),r=n.replace("[money]","-")):(t=n.replace("[money]",this.welfareTicketHistorySummary.betTotal()),r=n.replace("[money]",this.welfareTicketHistorySummary.winTotal())),m("div",null,m("div",{style:"display:flex;padding-bottom:10px"},m("div",{style:"font-size: 24px;font-weight: bold;display:inline-block;padding-right: 10px;"},y().translator.trans("wusong8899-welfare-ticket.forum.welfare-ticket-view-history")),m(b(),{className:"Button Button--primary",onclick:function(){return m.route.set(y().route("welfareTicket"))}},y().translator.trans("wusong8899-welfare-ticket.forum.purchase-now"))),m("div",{style:"color:var(--muted-color);padding-bottom:10px;"},y().translator.trans("wusong8899-welfare-ticket.forum.purchase-summary",{purchaseCostTotal:t,purchaseWinTotal:r})),m("ul",{style:"margin: 0;padding: 0;list-style-type: none;position: relative;"},this.welfareTicketHistory.map((function(e){return m("li",{style:"padding-bottom:5px","data-id":e.id()},T.component({welfareTicketHistory:e}))}))),!this.loading&&0===this.welfareTicketHistory.length&&m("div",null,m("div",{style:"font-size:1.4em;color: var(--muted-more-color);text-align: center;height: 300px;line-height: 100px;"},y().translator.trans("wusong8899-guaguale.forum.guaguale-history-list-empty"))),!e&&this.hasMoreResults()&&m("div",{style:"text-align:center;padding:20px"},m(b(),{className:"Button Button--primary",disabled:this.loading,loading:this.loading,onclick:function(){return a.loadMore()}},y().translator.trans("wusong8899-guaguale.forum.guaguale-history-list-load-more"))),e&&m("div",{className:"WelfareTicket-loadMore"},e))},r.loadMore=function(){this.loading=!0,this.loadResults(this.welfareTicketHistory.length)},r.parseResults=function(e){var t=this;return this.moreResults=!!e.payload.links&&!!e.payload.links.next,[].push.apply(this.welfareTicketHistory,e),y().store.find("welfareTicketPurchaseHistorySummary").catch((function(){})).then((function(r){return t.welfareTicketHistorySummary=r[0],t.loading=!1,m.redraw(),e}))},r.hasMoreResults=function(){return this.moreResults},r.loadResults=function(e){return void 0===e&&(e=0),y().store.find("welfareTicketPurchase",{filter:{user:this.user.id()},page:{offset:e}}).catch((function(){})).then(this.parseResults.bind(this))},t}(h()),z=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.loadUser(m.route.param("username"))},r.content=function(){return m("div",{className:"WelfareTicketPurchaseHistoryPage"},x.component({params:{user:this.user}}))},t}(u());const B=flarum.core.compat.Model;var N=e.n(B),M=function(e){function t(){return e.apply(this,arguments)||this}return f(t,e),t}(N());Object.assign(M.prototype,{id:N().attribute("id"),title:N().attribute("title"),desc:N().attribute("desc"),playback:N().attribute("playback"),color:N().attribute("color"),image:N().attribute("image"),type:N().attribute("type"),cost:N().attribute("cost"),purchased_total:N().attribute("purchased_total"),bet_total:N().attribute("bet_total"),dealer_id:N().attribute("dealer_id"),result:N().attribute("result"),settings:N().attribute("settings"),assignedAt:N().attribute("assigned_at"),activated:N().attribute("activated"),dealerData:N().hasOne("dealerData")});var D=function(e){function t(){return e.apply(this,arguments)||this}return f(t,e),t}(N());Object.assign(D.prototype,{id:N().attribute("id"),title:N().attribute("title"),welfare_id:N().attribute("welfare_id"),user_id:N().attribute("user_id"),bet:N().attribute("bet"),multiplier:N().attribute("multiplier"),numbers:N().attribute("numbers"),win_total:N().attribute("win_total"),opened:N().attribute("opened"),assigned_at:N().attribute("assigned_at"),welfareData:N().hasOne("welfareData")});var P=function(e){function t(){return e.apply(this,arguments)||this}return f(t,e),t}(N());Object.assign(P.prototype,{total_purchase_count:N().attribute("total_purchase_count"),total_win_count:N().attribute("total_win_count")});var _=function(e){function t(){return e.apply(this,arguments)||this}return f(t,e),t}(N());Object.assign(_.prototype,{betTotal:N().attribute("betTotal"),winTotal:N().attribute("winTotal")});const W=flarum.core.compat["components/Page"];var R=e.n(W);const H=flarum.core.compat["common/helpers/listItems"];var S=e.n(H);const I=flarum.core.compat["components/Modal"];var C=e.n(I);const O=flarum.core.compat["common/components/Alert"];var L=e.n(O);const j=flarum.core.compat["common/components/Select"];var A=e.n(j);const J=flarum.core.compat["utils/Stream"];var F=e.n(J);const G=flarum.core.compat["common/components/Modal"];var U=e.n(G);const q=flarum.core.compat["common/components/Button"];var E=e.n(q),K=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t)},r.className=function(){return"Modal--small"},r.title=function(){return a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-success")},r.content=function(){return[m("div",{className:"Modal-body"},m("div",{style:"text-align:center"},E().component({style:"width:66px",className:"Button Button--primary",onclick:function(){location.reload()}},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-ok"))))]},t}(U());K.isDismissible=!1;var Q=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.welfareTicketData=this.attrs.welfareTicketData,this.moneyName=a().forum.attribute("antoinefr-money.moneyname")||"[money]",this.currentMoney=a().session.user.attribute("money");var r=this.welfareTicketData.id().toString();this.welfareTicketID=r.substring(1),this.welfareTotalBall=3;var n=JSON.parse(this.welfareTicketData.settings());this.welfareTicketSelectedBallWinMultiplier={0:a().translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-none"),1:a().translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-count",{count:1,multiplier:n.win1Multiplier}),2:a().translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-count",{count:2,multiplier:n.win2Multiplier}),3:a().translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-count",{count:3,multiplier:n.win3Multiplier})},this.welfareTicketBall={ball1:F()(0),ball2:F()(0),ball3:F()(0)}},r.className=function(){return"Modal--small"},r.title=function(){return a().translator.trans("wusong8899-welfare-ticket.forum.welfare-item-season-3D",{id:this.welfareTicketID})},r.content=function(){var e=this,t=this.moneyName.replace("[money]",this.currentMoney),r=(this.moneyName.replace("[money]",0),this.welfareTicketBall.ball1()),n=this.welfareTicketBall.ball2(),i=this.welfareTicketBall.ball3();return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,a().translator.trans("wusong8899-welfare-ticket.forum.welfare-select-number")),m(A(),{style:"width:100px;",value:r,options:["无",0,1,2,3,4,5,6,7,8,9],buttonClassName:"Button",onchange:function(t){e.updateSelection(t,1)}}),m(A(),{style:"width:100px;margin-left:20px;",value:n,options:["无",0,1,2,3,4,5,6,7,8,9],buttonClassName:"Button",onchange:function(t){e.updateSelection(t,2)}}),m(A(),{style:"width:100px;margin-left:20px;",value:i,options:["无",0,1,2,3,4,5,6,7,8,9],buttonClassName:"Button",onchange:function(t){e.updateSelection(t,3)}}),m("div",{style:"padding-top:10px"},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-item-bet")),m("div",{style:"padding-top:10px"},m("input",{required:!0,id:"WelfareBetInput",className:"FormControl",type:"number",step:"0.01",min:"1",max:this.currentMoney,onchange:function(){return e.updateBetInput()},onkeyup:function(){return e.updateBetInput()}})),m("div",{style:"padding-top:10px"},a().translator.trans("wusong8899-guaguale.forum.guaguale-current-money-amount"),t),m("div",{style:"padding-top:10px"},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-multiplier"),m("span",{id:"welfareTicketWinMultiplierText"},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-current-selection-none")))),m("div",{className:"Form-group",style:"text-align: center;"},b().component({className:"Button Button--primary",type:"submit",loading:this.loading},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-ok"))," ",b().component({className:"Button transferMoneyButton--gray",loading:this.loading,onclick:function(){e.hide()}},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-cancel")))))},r.precisionRound=function(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r},r.updateSelection=function(e,t){this.welfareTicketBall["ball"+t](e);for(var r=0,a=1;a<=this.welfareTotalBall;a++)0!==parseInt(this.welfareTicketBall["ball"+a]())&&r++;$("#welfareTicketWinMultiplierText").text(this.welfareTicketSelectedBallWinMultiplier[r].join(""))},r.updateBetInput=function(){var e=this.precisionRound($("#WelfareBetInput").val(),2),t=this.currentMoney;e>t&&$("#WelfareBetInput").val(t)},r.onsubmit=function(e){var t=this;e.preventDefault();for(var r=this.precisionRound($("#WelfareBetInput").val(),2),n=this.welfareTicketID,i=[],o=1;o<=this.welfareTotalBall;o++){var l=parseInt(this.welfareTicketBall["ball"+o]());0===l||i.push(l-1)}if(0!==i.length)if(0!==r){var s={welfare_id:n,bet:r,type:1,numbers:i};this.loading=!0,a().store.createRecord("welfareTicketPurchase").save(s).then((function(e){a().store.pushPayload(e),a().modal.show(K),a().session.user.data.attributes.money-=r,t.loading=!1})).catch((function(e){t.loading=!1}))}else a().alerts.show(L(),{type:"error"},a().translator.trans("wusong8899-welfare-ticket.forum.purchase-error-no-bet"));else a().alerts.show(L(),{type:"error"},a().translator.trans("wusong8899-welfare-ticket.forum.purchase-error-no-number-selected"))},t}(C());Q.isDismissible=!1;var V=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t)},r.className=function(){return"Modal--small"},r.title=function(){return a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-dealer-success")},r.content=function(){return[m("div",{className:"Modal-body"},m("div",{style:"text-align:center"},E().component({style:"width:66px",className:"Button Button--primary",onclick:function(){location.reload()}},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-ok"))))]},t}(U());V.isDismissible=!1;var X=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.welfareTicketData=this.attrs.welfareTicketData;var r=JSON.parse(this.welfareTicketData.settings());this.welfareTicketDealerBet=this.precisionRound(r.dealerBet,2),this.currentMoney=a().session.user.attribute("money")},r.className=function(){return"Modal--small"},r.title=function(){return a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-dealer")},r.content=function(){var e=this,t=a().forum.attribute("antoinefr-money.moneyname")||"[money]",r=t.replace("[money]",this.currentMoney),n=t.replace("[money]",this.welfareTicketDealerBet);return this.currentMoney>=this.welfareTicketDealerBet?[m("div",{className:"Modal-body"},m("h3",null,a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-dealer-confirm",{cost:n,money:r})),m("div",{style:"text-align:center;padding-top: 20px;"},b().component({style:"width:66px",className:"Button Button--primary",type:"submit"},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-ok"))," ",b().component({className:"Button transferMoneyButton--gray",loading:this.loading,onclick:function(){e.hide()}},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-cancel"))))]:[m("div",{className:"Modal-body"},m("h3",null,a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-dealer-insuffcient-fund",{cost:n,money:r})),m("div",{style:"text-align:center;padding-top: 20px;"},b().component({style:"width:66px",className:"Button Button--primary",onclick:function(){e.hide()}},a().translator.trans("wusong8899-welfare-ticket.forum.welfare-purchase-ok"))))]},r.precisionRound=function(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r},r.onsubmit=function(e){var t=this;e.preventDefault(),this.welfareTicketData.save({purchaseDealer:!0}).then((function(){a().session.user.data.attributes.money-=t.welfareTicketDealerBet,a().modal.show(V)}),(function(e){t.loading=!1}))},t}(C());X.isDismissible=!1;const Y=flarum.core.compat["components/LogInModal"];var Z=e.n(Y);const ee=flarum.core.compat["helpers/username"];var te=e.n(ee),re=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.loading=!0},r.view=function(){var e=this,t=app.forum.attribute("antoinefr-money.moneyname")||"[money]",r=this.attrs.welfareTicketData,a=r.id().toString().substring(1),n=r.image(),i=(r.type(),r.playback()),o=r.color(),l=r.dealer_id(),s=null===r.result()?[]:JSON.parse(r.result()),c=r.assignedAt(),u="background-image:url("+(null===n?"":n)+");background-color: "+(o||this.getBackgroundColor(c))+";",p=o?"opacity: 0.9;":"",f=r.activated(),d=r.bet_total(),h=JSON.parse(r.settings()),w=h.dealerBet,y=h.dealerBetCut,v=t.replace("[money]",w),k=t.replace("[money]",d),g=r.dealerData(),b=!1===g?app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-dealer-none"):te()(g),T=null===l?"display: inline-block;width: 165px;":"display: inline-block;";return m("div",null,m("div",{class:"WelfareTicketContainer",style:u},m("div",{class:"WelfareTicketMask",style:"background: var(--shadow-color);"},m("div",{class:"WelfareTicketSeason"},m("div",{style:"position: absolute;color: lightgoldenrodyellow;"},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-season-3D",{id:a})),m("div",{style:"filter: blur(20px);",class:"WelfareRainbowTextAnimated"},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-season-3D",{id:a}))),m("div",{class:"WelfareTicketDealer"},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-dealer-name"),": ",b," | ",app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-dealerBet"),":",v,"  (",app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-dealerBetCut"),y,"%)"),m("div",{class:"WelfareTicketResult",style:"height:60px"},0===f&&0===s.length&&m("div",{class:"WelfareFadingAnimated",style:"height:50px;display:inline-block;color: lightgoldenrodyellow;"},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-bet-closed")),1===f&&0===s.length&&m("div",{style:"height: 50px;"},m("div",{style:T},m("div",{class:"WelfareTicketAssignTicket buttonRegister",onclick:function(){return e.purchaseTicket(r)}},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-bet-now"))),null===l&&m("div",{style:"display:inline-block"},m("div",{class:"WelfareTicketAssignDealer buttonRegister",onclick:function(){return e.purchaseDealer(r)}},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-become-dealer")))),0===f&&s.length>0&&s.map((function(e){return m("div",{style:"margin-left: 2px;padding: 4px;height: 70px;"},m("div",{class:"WelfareTicketBallBlue",style:p},e))}))),m("div",{class:"WelfareTicketDetails"},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-item-bet-total"),":",k))),null!==i&&0===s.length&&m("div",{style:"padding-top: 10px;"},m("h3",{style:"display: flex;align-items: center;"},m("div",{class:"WelfareTicketReminder"})," ",app.translator.trans("wusong8899-welfare-ticket.forum.welfare-playback")),m("video",{controls:"controls",style:"width: 100%;border-radius: 12px;"},m("source",{src:i,type:"video/mp4"}))))},r.purchaseTicket=function(e){app.session.user?app.modal.show(Q,{welfareTicketData:e}):app.modal.show(Z())},r.purchaseDealer=function(e){app.session.user?app.modal.show(X,{welfareTicketData:e}):app.modal.show(Z())},r.getBackgroundColor=function(e){for(var t=0,r=0;r<e.length;r++)t=e.charCodeAt(r)+((t<<5)-t);for(var a="#",n=0;n<3;n++)a+=("00"+(t>>8*n&255).toString(16)).substr(-2);return a},t}(h()),ae=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.bodyClass="App--index",this.loading=!0,this.welfareTicketList=[],this.loadResults()},r.view=function(){var e,t=this;return this.loading&&(e=k().component({size:"large"})),m("div",{className:"IndexPage"},o().prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,S()(o().prototype.sidebarItems().toArray()))),m("div",{class:"WelfareTicketGlobalContainer"},this.welfareTicketList.map((function(e){return m("div",{style:"padding-top:5px;"},re.component({welfareTicketData:e}))})),!this.loading&&m("div",{style:"padding-top:10px;"},m("div",{style:"display: flex;align-items: center;padding-bottom: 10px;"},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-ticket-result-reminder")),b().component({className:"Button",onclick:function(){t.showPurchaseHistory()}},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-ticket-view-history"))," ",b().component({className:"Button",onclick:function(){t.showWelfareHistory()}},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-ticket-history"))),!this.loading&&0===this.welfareTicketList.length&&m("div",null,m("div",{style:"font-size:1.4em;color: var(--muted-more-color);text-align: center;height: 300px;line-height: 100px;"},app.translator.trans("wusong8899-guaguale.forum.guaguale-list-empty"))),e&&m("div",{className:"WelfareTicket-loadMore"},e)))))},r.parseResults=function(e){return[].push.apply(this.welfareTicketList,e),this.loading=!1,m.redraw(),e},r.parsePurchaseResults=function(e){return[].push.apply(this.guagualePurchaseCountList,e),this.loading=!1,m.redraw(),e},r.loadResults=function(){return app.store.find("welfareTicketList",{page:{filter:{item:"active"}}}).catch((function(){})).then(this.parseResults.bind(this))},r.showPurchaseHistory=function(){m.route.set(app.route("user.welfareTicketPurchaseHistory",{username:app.session.user.username()}))},r.showWelfareHistory=function(){m.route.set(app.route("welfareTicketHistory"))},t}(R()),ne=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.bodyClass="App--index",this.loading=!0,this.welfareTicketList=[],this.loadResults()},r.view=function(){var e,t=this;return this.loading&&(e=k().component({size:"large"})),m("div",{className:"IndexPage"},o().prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,S()(o().prototype.sidebarItems().toArray()))),m("div",{class:"WelfareTicketGlobalContainer"},this.welfareTicketList.map((function(e){return m("div",{style:"padding-top:5px;"},re.component({welfareTicketData:e}))})),!this.loading&&m("div",{style:"padding-top:10px;"},b().component({className:"Button",onclick:function(){t.showPurchaseHistory()}},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-ticket-view-history"))," ",b().component({className:"Button",onclick:function(){t.showWelfare()}},app.translator.trans("wusong8899-welfare-ticket.forum.welfare-ticket-current"))),!this.loading&&0===this.welfareTicketList.length&&m("div",null,m("div",{style:"font-size:1.4em;color: var(--muted-more-color);text-align: center;height: 300px;line-height: 100px;"},app.translator.trans("wusong8899-guaguale.forum.guaguale-list-empty"))),e&&m("div",{className:"WelfareTicket-loadMore"},e)))))},r.parseResults=function(e){return[].push.apply(this.welfareTicketList,e),this.loading=!1,m.redraw(),e},r.parsePurchaseResults=function(e){return[].push.apply(this.guagualePurchaseCountList,e),this.loading=!1,m.redraw(),e},r.loadResults=function(){return app.store.find("welfareTicketList",{page:{filter:{item:"history"}}}).catch((function(){})).then(this.parseResults.bind(this))},r.showPurchaseHistory=function(){m.route.set(app.route("user.welfareTicketPurchaseHistory",{username:app.session.user.username()}))},r.showWelfare=function(){m.route.set(app.route("welfareTicket"))},t}(R());const ie=flarum.core.compat["components/Notification"];var oe=function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var r=t.prototype;return r.icon=function(){return"fas fa-ticket-alt"},r.href=function(){return a().route("user.welfareTicketPurchaseHistory",{username:a().session.user.username()})},r.content=function(){var e=this.attrs.notification.subject(),t="dealer"===e.numbers(),r=e.welfare_id().toString().substring(1),n=a().translator.trans("wusong8899-welfare-ticket.forum.welfare-item-season-3D",{id:r});return!0===t?a().translator.trans("wusong8899-welfare-ticket.forum.notifications.open-content-dealer",{title:n}):a().translator.trans("wusong8899-welfare-ticket.forum.notifications.open-content",{title:n})},r.excerpt=function(){var e=this.attrs.notification.subject(),t="dealer"===e.numbers(),r=e.win_total(),n=e.bet(),i=e.id(),o=a().forum.attribute("antoinefr-money.moneyname")||"[money]",l=o.replace("[money]",r),s=o.replace("[money]",n);if(!0===t){var c=r-n,u=o.replace("[money]",Math.abs(c));return c>0?a().translator.trans("wusong8899-welfare-ticket.forum.notifications.win-total-positive-dealer",{costTotal:s,winTotal:l,profitTotal:u,purchaseID:i}):a().translator.trans("wusong8899-welfare-ticket.forum.notifications.win-total-negative-dealer",{costTotal:s,winTotal:l,profitTotal:u,purchaseID:i})}return a().translator.trans("wusong8899-welfare-ticket.forum.notifications.win-total",{costTotal:s,winTotal:l,purchaseID:i})},t}(e.n(ie)());const le=flarum.core.compat["components/NotificationGrid"];var se=e.n(le);a().initializers.add("wusong8899-welfare-ticket",(function(){a().store.models.welfareTicketList=M,a().store.models.welfareTicketPurchase=D,a().store.models.welfareTicketPurchaseCount=P,a().store.models.welfareTicketPurchaseHistorySummary=_,a().notificationComponents.welfareTicketPurchase=oe,a().routes.welfareTicket={path:"/welfareTicket",component:ae},a().routes.welfareTicketHistory={path:"/welfareTicketHistory",component:ne},(0,n.extend)(o().prototype,"navItems",(function(e){var t=a().forum.attribute("welfareDisplayName"),r=""===t?a().translator.trans("wusong8899-welfare-ticket.forum.welfare-display-name-default"):t;return e.add("WelfareTicket",m(s(),{icon:"fas fa-ticket-alt",href:a().route("welfareTicket")},r),15),e})),app.routes["user.welfareTicketPurchaseHistory"]={path:"/u/:username/welfareTicketPurchaseHistory",component:z},(0,n.extend)(u().prototype,"navItems",(function(e,t){app.session.user&&app.session.user.id()==this.user.id()&&e.add("welfareTicketPurchaseHistory",s().component({href:app.route("user.welfareTicketPurchaseHistory",{username:this.user.username()}),icon:"fas fa-ticket-alt"},[app.translator.trans("wusong8899-welfare-ticket.forum.welfare-ticket-purchase-history")]),10)})),(0,n.extend)(se().prototype,"notificationTypes",(function(e){e.add("welfareTicketPurchase",{name:"welfareTicketPurchase",icon:"fas fa-ticket-alt",label:a().translator.trans("wusong8899-welfare-ticket.forum.welfare-receive-open-result")})}))}))})(),module.exports=t})();
//# sourceMappingURL=forum.js.map